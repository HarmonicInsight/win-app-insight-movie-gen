# InsightCast 実装計画（国内販売特化）

作成日: 2026年2月20日
改訂: 2026年2月20日（マーケティング視点で再構成）

---

## 判断基準：顧客導線のどこで離脱するか

```
YouTube広告 → insightcast.jp LP → 無料DL → 初回起動 → 体験 → 「これだ」→ Business契約
```

この導線の**各ステップで何がボトルネックになるか**を基準に優先度を決定。

---

## 致命的ギャップ TOP 5

insightcast.jp が約束していることと、現アプリで実現できていないこと。

| # | LPの約束 | 現アプリの現実 | 離脱インパクト |
|---|---|---|---|
| 1 | 製品名「InsightCast」 | UIに「InsightMovie」と表示される | **致命的** — 広告とアプリが別物に見える |
| 2 | 「ドラッグ&ドロップ」 | ファイル選択ダイアログのみ | **高** — LP Step 1 と体験が不一致 |
| 3 | 「PDF対応」 | PDF取込不可 | **高** — 建設・製造の教材はPDFが主流 |
| 4 | 「資料をアップロードするだけで完成」 | シーンエディタUIが表示される | **高** — 編集ソフトに見えて離脱 |
| 5 | PPTX → 自動で動画化 | PPTX取込はあるがスライド画像にPowerPoint必須 | **中** — ターゲット層にPPT未インストールが多い |

---

## 優先度付き実装ロードマップ

### Priority 1: 信頼の土台（これが無いと広告費が無駄になる）

#### P1-1. ブランドリネーム：InsightMovie → InsightCast
**なぜ最優先か**: 広告→LP→DL→起動で「InsightMovie」が表示されたら、ユーザーは「違うアプリをDLした？」と思って閉じる。**広告のCPAが全て無駄になる**。

**変更範囲**:

| カテゴリ | 変更対象 | ファイル数 |
|---|---|---|
| プロジェクト構造 | .sln, .csproj, フォルダ名 | 3 |
| C# namespace/using | 全 .cs ファイル | 32 |
| XAML xmlns/x:Class | 全 .xaml ファイル | 8 |
| UI表示文字列 | タイトルバー, About, Tutorial, エラーダイアログ | 10箇所 |
| 設定パス | Config, AudioCache, ExportService の temp パス | 3 |
| ライセンスコード | INMV → INCS（旧コードも受付維持） | 1 |
| ビルド | build.ps1, Installer, app.manifest | 3 |

**工数**: 1日
**リスク**: 低（機械的な置換が主体）

#### P1-2. ドラッグ&ドロップ対応
**なぜ重要か**: LPの Step 1 で「ドラッグ&ドロップ」と明記。これが無いとLPが嘘になる。

**実装内容**:
- `MainWindow.xaml` に `AllowDrop="True"` を追加
- `MainWindow.xaml.cs` に `DragEnter` / `Drop` イベントハンドラ
- 対応形式: `.pptx`, `.pdf`, `.png`, `.jpg`, `.jpeg`, `.bmp`, `.gif`, `.mp4`, `.txt`
- ドロップされたファイル種別に応じて適切な取込処理を自動振り分け:
  - PPTX → ImportPptx フロー
  - PDF → ImportPdf フロー（P1-3で実装）
  - 画像 → 新規シーンとして追加
  - 動画 → 新規シーンとして追加
  - テキスト → ImportText フロー
- ドロップエリアのビジュアルフィードバック（枠線ハイライト）

**変更ファイル**: `MainWindow.xaml`, `MainWindow.xaml.cs`, `MainWindowViewModel.cs`
**工数**: 1日
**依存**: P1-1（namespace変更後に実装）

#### P1-3. PDF取込
**なぜ重要か**: LPに「PowerPoint、画像、PDF」と明記。建設・製造業の教育資料はPDF配布が圧倒的に多い。「PDFが使えない」は購入断念の直接原因。

**実装内容**:
- 新規ファイル: `Utils/PdfImporter.cs`
- NuGet追加: `UglyToad.PdfPig`（テキスト抽出、Apache 2.0ライセンス）
- PDFページ → 画像変換: FFmpegの`-i` でPDFは扱えないため、代替手段が必要
  - 案A: `SkiaSharp` + `SkiaSharp.Views.WPF` でPDFレンダリング（推奨）
  - 案B: PDFページをスクリーンキャプチャ的に変換
- 各ページのテキストを抽出 → NarrationText に設定
- PptxImporter と同じ `SlideData` パターンで出力
- MainWindowViewModel に `ImportPdfCommand` 追加
- MainWindow.xaml のヘッダーバーに「PDF取込」ボタン追加

**変更ファイル**: 新規 `Utils/PdfImporter.cs`, `MainWindowViewModel.cs`, `MainWindow.xaml`, `.csproj`
**工数**: 3-5日
**依存**: P1-1

---

### Priority 2: 初回体験の改善（Free→Businessの転換率直結）

#### P2-1. 「かんたんモード」— ワンクリック動画生成
**なぜ重要か**: LPは「資料をアップロードするだけで完成」と謳っているが、現アプリは**シーンエディタ**。現場管理者が起動して「シーン一覧」「トランジション」「字幕スタイル」を見たら「これは編集ソフトだ、自分には無理」と閉じる。

**「アップロードするだけ」を実現する導線が必要。**

**実装内容**:
- 起動時またはメニューから選べる「かんたんモード」画面を追加
- UI構成:
  ```
  ┌──────────────────────────────────┐
  │  InsightCast                      │
  │                                   │
  │  ┌─────────────────────────────┐  │
  │  │                             │  │
  │  │   ここに資料をドロップ       │  │
  │  │   （PPT・PDF・画像）        │  │
  │  │                             │  │
  │  └─────────────────────────────┘  │
  │                                   │
  │  話者: [▼ 青山龍星（ノーマル）]   │
  │  解像度: [▼ 1080x1920 (縦)]      │
  │                                   │
  │  [ 動画を生成 ]                   │
  │                                   │
  │  ─── または ───                   │
  │  [詳細エディタで開く]             │
  └──────────────────────────────────┘
  ```
- ドロップ → 自動シーン構成 → 即エクスポート（話者・解像度のみ選択）
- 生成後、詳細エディタに切り替えて微調整も可能
- 「詳細エディタで開く」で従来のMainWindow表示

**新規ファイル**: `Views/QuickMode.xaml`, `Views/QuickMode.xaml.cs`, `ViewModels/QuickModeViewModel.cs`
**変更ファイル**: `App.xaml.cs`（起動フロー分岐）
**工数**: 5-7日
**依存**: P1-1, P1-2, P1-3

#### P2-2. サンプルプロジェクト内蔵
**なぜ重要か**: 初回起動時に空のエディタが表示されると「何をすればいいかわからない」。FAQで「動画編集経験は不要」と書いているなら、**体験で証明する必要がある**。

**実装内容**:
- アプリ内蔵のサンプルPPTX（3-5スライド、建設安全教育テーマ）
- 初回起動時「サンプル動画を生成してみる」ボタン表示
- ワンクリックでサンプルをロード → かんたんモードで即生成体験
- 「30秒で動画ができた！」の成功体験を初回で提供

**新規ファイル**: `Resources/sample_project.pptx`（埋め込みリソース）
**変更ファイル**: `Views/SetupWizard.xaml`（最終ページにサンプル生成ボタン追加）, `App.xaml.cs`
**工数**: 2-3日
**依存**: P2-1

#### P2-3. PPTX取込のCOM非依存化
**なぜ重要か**: 現在のPPTXスライド画像エクスポートは PowerPoint COM interop 必須。ターゲットの現場管理者の多くはPowerPointがインストールされていない。LP で「PowerPointをアップロード」と言っているのに、PowerPointのインストールが必要なのは矛盾。

**実装内容**:
- `PptxImporter.cs` の `ExportPngsWin32()` に代替レンダリングを追加
- 案A（推奨）: OpenXml でスライドのレイアウト情報を読み取り、SkiaSharp でレンダリング
- 案B: LibreOffice CLI（soffice --headless --convert-to png）をフォールバックとして利用
- 案C: スライドのテキスト＋ノートのみ取得し、画像はスキップ（現在のフォールバック動作を明示化）
- COM利用可能時は高品質レンダリング、不可時はフォールバックで対応

**変更ファイル**: `Utils/PptxImporter.cs`
**新規NuGet**: `SkiaSharp`（案Aの場合）
**工数**: 5-7日
**依存**: P1-1

---

### Priority 3: 法人契約の安心材料

#### P3-1. 一時ファイル自動削除
**なぜ重要か**: LPで「暗号化環境で処理後、自動削除」と明記。法人のIT部門がセキュリティチェックシートで確認する項目。**Enterprise契約のブロッカー**になりうる。

**実装内容**:
- エクスポート完了後、`insightcast_build/` ディレクトリの中間ファイルを即削除
- アプリ終了時（`App.OnExit`）にキャッシュディレクトリのクリーンアップ
- 設定で「終了時にキャッシュを自動削除」のオン/オフ（デフォルトオン）
- オーディオキャッシュ（`AudioCache`）にも有効期限（7日）を追加

**変更ファイル**: `Services/ExportService.cs`, `VoiceVox/AudioCache.cs`, `App.xaml.cs`, `Core/Config.cs`
**工数**: 1-2日
**依存**: P1-1

#### P3-2. テキストファイル取込
**なぜ重要か**: 直接のLP約束ではないが、「原稿テキストから動画を作りたい」というニーズは高い。手順書がWordやテキストで残っている現場が多い。

**実装内容**:
- 新規ファイル: `Utils/TextImporter.cs`
- `.txt` / `.md` ファイルを読み込み
- 空行区切りで段落分割 → 各段落を1シーンに
- ナレーションテキスト = 段落テキスト
- 画像なし → 黒背景（既存の GenerateBlankVideo で対応済み）
- ドラッグ&ドロップ（P1-2）と連携

**新規ファイル**: `Utils/TextImporter.cs`
**変更ファイル**: `MainWindowViewModel.cs`
**工数**: 1-2日
**依存**: P1-1, P1-2

#### P3-3. 一括画像取込
**なぜ重要か**: 現場で撮った写真10枚をまとめて教育動画にしたい。1枚ずつ「シーン追加→素材選択」は面倒で離脱する。

**実装内容**:
- ファイル選択ダイアログを複数選択対応に変更
- 複数画像選択 → 画像数分のシーンを自動追加（各画像がMediaPathに設定済み）
- ドラッグ&ドロップ（P1-2）でも複数ファイル対応
- 追加後に自動的に最初の新規シーンを選択

**変更ファイル**: `MainWindowViewModel.cs`, `Services/DialogService.cs`
**工数**: 1日
**依存**: P1-1, P1-2

---

## 実装スケジュール

```
Week 1:
├── P1-1 ブランドリネーム                    [1日] ★ 最優先
├── P1-2 ドラッグ&ドロップ                   [1日]
├── P1-3 PDF取込                            [3-5日] ←ここまでで「LPの約束」を全て実現
│
Week 2:
├── P2-1 かんたんモード                      [5-7日] ←これでFree→Business転換率が変わる
│
Week 3:
├── P2-2 サンプルプロジェクト               [2-3日]
├── P2-3 PPTX COM非依存化                   [5-7日]
├── P3-1 一時ファイル自動削除               [1-2日]
├── P3-2 テキストファイル取込               [1-2日]
├── P3-3 一括画像取込                       [1日]
```

**Week 1 終了時点で広告を開始できる**（LPの約束と製品が一致するため）。
Week 2-3 は広告運用と並行して改善。

---

## 工数サマリー

| Priority | 項目数 | 合計工数 | ビジネスインパクト |
|---|---|---|---|
| **P1: 信頼の土台** | 3項目 | **5-7日** | 広告費が無駄にならない |
| **P2: 初回体験** | 3項目 | **12-17日** | Free→Business転換率UP |
| **P3: 法人安心材料** | 3項目 | **3-5日** | Enterprise契約のブロッカー除去 |
| **合計** | **9項目** | **20-29日** | |

---

## 対象外（今回のスコープ外）

| 機能 | 理由 |
|---|---|
| 多言語TTS | 国内販売では日本語VOICEVOXで十分。将来のグローバル展開時に検討 |
| プラン制限（透かし・月次カウント・ロゴ挿入） | 他Insight製品と統一設計が必要。別途対応 |
| API/LMS/SharePoint連携 | Enterprise個別案件で対応。汎用実装は時期尚早 |
| SSO/IP制限 | Enterprise個別案件 |
| SaaS化/Web版 | デスクトップ版の成熟が先 |
